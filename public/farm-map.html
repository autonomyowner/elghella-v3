<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farm Map</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom Styles -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            text-align: center;
            padding: 30px 20px;
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .map-container {
            padding: 20px;
            background: #f8f9fa;
        }
        
        #map {
            width: 100%;
            height: 600px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 3px solid #4CAF50;
        }
        
        /* Custom popup styling */
        .leaflet-popup-content-wrapper {
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .farm-popup {
            text-align: center;
            font-family: 'Arial', sans-serif;
            direction: rtl;
        }
        
        .farm-popup h3 {
            color: #4CAF50;
            margin-bottom: 10px;
            font-size: 1.4em;
        }
        
        .farm-popup .crop-info {
            background: #f0f8f0;
            padding: 10px;
            border-radius: 8px;
            margin: 8px 0;
        }
        
        .farm-popup .crop-type {
            color: #2e7d32;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .farm-popup .plant-date {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        /* Layer control styling */
        .leaflet-control-layers {
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* Info panel */
        .info-panel {
            background: white;
            margin: 20px;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            direction: rtl;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .feature {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
            text-align: right;
        }
        
        .feature-icon {
            font-size: 1.5em;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            🌾 Interactive Farm Map
        </div>
        
        <!-- Map Container -->
        <div class="map-container">
            <div id="map"></div>
        </div>
        
        <!-- Info Panel -->
        <div class="info-panel">
            <h2>🗺️ خريطة المزارع التفاعلية</h2>
            <p>استكشف المزارع والحقول الزراعية في منطقة الجزائر العاصمة</p>
            
            <div class="features">
                <div class="feature">
                    <span class="feature-icon">🌍</span>
                    <strong>عرض الخريطة:</strong> تبديل بين الخريطة العادية والقمر الصناعي
                </div>
                <div class="feature">
                    <span class="feature-icon">📍</span>
                    <strong>مواقع المزارع:</strong> انقر على العلامات لعرض تفاصيل المحاصيل
                </div>
                <div class="feature">
                    <span class="feature-icon">🌾</span>
                    <strong>معلومات المحاصيل:</strong> نوع المحصول وتاريخ الزراعة
                </div>
                <div class="feature">
                    <span class="feature-icon">🚜</span>
                    <strong>إدارة المزارع:</strong> تتبع حالة المحاصيل والأنشطة الزراعية
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Initialize map centered on Algiers, Algeria
        const map = L.map('map').setView([36.7538, 3.0588], 13);

        // Define base layers
        const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors',
            maxZoom: 19
        });

        // Esri Satellite imagery layer
        const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles © Esri — Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
            maxZoom: 19
        });

        // Add default layer (OSM)
        osmLayer.addTo(map);

        // Create base layer control
        const baseLayers = {
            "🗺️ الخريطة العادية": osmLayer,
            "🛰️ صور الأقمار الصناعية": satelliteLayer
        };

        // Add layer control
        L.control.layers(baseLayers).addTo(map);

        // Custom farm icon
        const farmIcon = L.divIcon({
            html: '<div style="background: #4CAF50; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); border: 3px solid white;">🌾</div>',
            iconSize: [40, 40],
            className: 'custom-farm-icon'
        });

        // Add farm markers with detailed information
        const farms = [
            {
                coords: [36.7538, 3.0588],
                name: "مزرعة الأمل",
                crop: "القمح",
                plantedDate: "مارس 2024",
                area: "15 هكتار",
                owner: "محمد أحمد"
            },
            {
                coords: [36.7608, 3.0688],
                name: "حقل الزيتون المبارك",
                crop: "أشجار الزيتون",
                plantedDate: "أكتوبر 2020",
                area: "8 هكتار",
                owner: "فاطمة بن علي"
            },
            {
                coords: [36.7458, 3.0488],
                name: "مزرعة النجاح",
                crop: "الطماطم",
                plantedDate: "أبريل 2024",
                area: "3 هكتار",
                owner: "عبد الرحمن محمود"
            },
            {
                coords: [36.7638, 3.0788],
                name: "حقل البركة",
                crop: "الذرة",
                plantedDate: "مايو 2024",
                area: "12 هكتار",
                owner: "خديجة يوسف"
            },
            {
                coords: [36.7338, 3.0388],
                name: "مزرعة الخير",
                crop: "البرتقال",
                plantedDate: "نوفمبر 2021",
                area: "6 هكتار",
                owner: "أحمد العربي"
            }
        ];

        // Add markers to map
        farms.forEach(farm => {
            const marker = L.marker(farm.coords, { icon: farmIcon }).addTo(map);
            
            const popupContent = `
                <div class="farm-popup">
                    <h3>🌾 ${farm.name}</h3>
                    <div class="crop-info">
                        <div class="crop-type">🌱 نوع المحصول: ${farm.crop}</div>
                        <div class="plant-date">📅 تاريخ الزراعة: ${farm.plantedDate}</div>
                        <div class="plant-date">📏 المساحة: ${farm.area}</div>
                        <div class="plant-date">👨‍🌾 المالك: ${farm.owner}</div>
                    </div>
                    <div style="margin-top: 10px; padding: 8px; background: #e8f5e8; border-radius: 5px; font-size: 0.9em;">
                        💡 انقر لعرض المزيد من التفاصيل
                    </div>
                </div>
            `;
            
            marker.bindPopup(popupContent, {
                maxWidth: 300,
                className: 'custom-popup'
            });
        });

        // Add a scale control
        L.control.scale().addTo(map);

        // Add custom zoom control with Arabic labels
        map.removeControl(map.zoomControl);
        L.control.zoom({
            zoomInTitle: 'تكبير',
            zoomOutTitle: 'تصغير'
        }).addTo(map);

        // Add location marker for current position (if available)
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                const userLat = position.coords.latitude;
                const userLng = position.coords.longitude;
                
                const userIcon = L.divIcon({
                    html: '<div style="background: #ff4444; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.3); border: 2px solid white;">📍</div>',
                    iconSize: [20, 20],
                    className: 'user-location-icon'
                });
                
                L.marker([userLat, userLng], { icon: userIcon })
                    .addTo(map)
                    .bindPopup('📍 موقعك الحالي')
                    .openPopup();
            });
        }

        // Add map click event for future expansion
        map.on('click', function(e) {
            console.log('Map clicked at: ' + e.latlng);
            // Future: Add new farm locations
        });

        // Console information
        console.log('🌾 Farm Map Initialized!');
        console.log('📍 Centered on Algiers, Algeria');
        console.log('🗺️ OSM and Satellite layers available');
        console.log('👨‍🌾 ' + farms.length + ' farm locations loaded');
    </script>
</body>
</html>

<!-- 
🚀 FUTURE ENHANCEMENTS:

1. **Leaflet.draw Integration:**
   Add this script: <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
   And CSS: <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"/>
   
   Then add drawing controls:
   const drawControl = new L.Control.Draw({
       edit: { featureGroup: drawnItems },
       draw: { polygon: true, rectangle: true, circle: true, marker: true }
   });
   map.addControl(drawControl);

2. **Weather Overlays:**
   Use OpenWeatherMap API for weather data:
   const weatherLayer = L.tileLayer('https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=YOUR_API_KEY');
   
   Add weather controls:
   const weatherLayers = {
       "🌧️ هطول الأمطار": precipitationLayer,
       "🌡️ درجة الحرارة": temperatureLayer,
       "💨 سرعة الرياح": windLayer
   };

3. **Real-time Data:**
   - Connect to IoT sensors for soil moisture, temperature
   - Add WebSocket connection for live updates
   - Integrate with weather APIs for forecasts

4. **Advanced Features:**
   - Crop health analysis using satellite imagery
   - Irrigation planning tools
   - Pest and disease tracking
   - Yield prediction models

5. **Database Integration:**
   - Connect to backend API for farm data
   - User authentication for farm management
   - Historical data visualization
   - Mobile app synchronization
-->